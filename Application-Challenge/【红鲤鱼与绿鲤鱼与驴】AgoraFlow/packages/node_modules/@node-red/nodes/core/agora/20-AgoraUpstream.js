
module.exports = function(RED) {
    function AgoraUpstreamNode(config) {
        RED.nodes.createNode(this,config);
        var node = this;
        // node.on('input', function(msg) {
        //     console.log("Here!")
        //     msg.payload = msg.payload.toLowerCase();
        //     node.send(msg);
        // });

        node.on("input", function(msg, send, done){
            let gMsg = getGlobalMsg(msg);
            if (!gMsg.payload.upstreamOptions){
                gMsg.payload.upstreamOptions = [];
            }
            gMsg.payload.upstreamOptions.push(config.upstreamOptions);
            // console.error("AgoraUpstream", msg);
        });
    }
    RED.nodes.registerType("agora-upstream",AgoraUpstreamNode);
}